{"title":"SHAP算法原理","uid":"feee444778bd7ce32a76dc60cad27adf","slug":"Shapley","date":"2024-07-07T14:15:09.000Z","updated":"2024-08-30T05:50:59.413Z","comments":true,"path":"api/articles/Shapley.json","keywords":null,"cover":[],"content":"<h3 id=\"Shapley值\"><a href=\"#Shapley值\" class=\"headerlink\" title=\"Shapley值\"></a>Shapley值</h3><p>1953年，Shapley值首次提出。Lloyd Shapley在论文《A Value for n-Person Games》中首次提出Shapley值。Shapley值是合作博弈论中的一个解决方案，它提供了一种在玩家之间公平分配支出的数学方法。从此成为联盟博弈论的基石，经常被用来确定团体内公平有效的资源分配策略，包括在股东之间分配利润、在合作者之间分配成本以及将功劳分配给研究项目的贡献者。然而，它与机器学习的交集要到五十年后才有。</p>\n<h3 id=\"Shapley值计算\"><a href=\"#Shapley值计算\" class=\"headerlink\" title=\"Shapley值计算\"></a>Shapley值计算</h3><p>假设以下情形：已经训练了一个机器学习模型来预测公寓价格，分别有park、size、floor、car四个特征。</p>\n<p>某个面积为50平方米（size&#x3D;50）、位于二楼（floor&#x3D;2nd）、附近有一个公园（park&#x3D;nearby）、禁止猫咪（cat&#x3D;banned）的公寓，它预测价格为300,000欧元，你需要解释这个预测，即每个特征是如何促进预测的？当所有公寓的平均预测为310,000欧元时，与平均预测相比，每个特征值对预测的贡献是多少？</p>\n<p><strong>线性回归模型的答案很简单，每个特征的贡献是特征的权重乘以特征值，但这仅适用于线性模型</strong></p>\n<p>park&#x3D;nearby，cat&#x3D;banned，size&#x3D;50，floor&#x3D;2nd的特征值共同实现了300,000欧元的预测，而我们的目标是解释实际预测（300,000欧元）和平均预测（310,000欧元）之间的差异：-10,000欧元。</p>\n<p>答案可能是：park&#x3D;nearby贡献了30,000欧元，size&#x3D;50贡献了10,000欧元，floor&#x3D;2nd贡献了0欧元，cat&#x3D;banned贡献了-50,000欧元，这些贡献加起来为-10,000欧元，最终预测为平均预测加上该贡献之和。</p>\n<p><strong>那么我们该如何计算目标公寓实例各特征的Shapley值呢？</strong></p>\n<p>在下面中，我们估计了cat&#x3D;banned特征值被添加到park&#x3D;nearby和size&#x3D;50的联盟后的贡献。</p>\n<p>第一步，我们从数据中随机抽取另一个公寓（随机找一个floor&#x3D;1st的公寓），使用该公寓自己的floor特征值1st，模拟出park&#x3D;nearby，size&#x3D;50和cat&#x3D;banned的联盟，然后我们用这个组合（floor&#x3D;1st，park&#x3D;nearby，size&#x3D;50，cat&#x3D;banned）预测公寓的价格为310,000欧元，这个估计值取决于随机抽取的公寓的值，这称之为基线值。</p>\n<p>第二步，我们从联盟中删除cat&#x3D;banned，然后用该公寓的cat特征值allowed替代，我们用这个组合（floor&#x3D;1st，park&#x3D;nearby，size&#x3D;50，cat&#x3D;allowed）预测公寓的价格为320,000欧元。</p>\n<p>第三步，重复以上过程，floor取另一个值，直到找完，就找完了被添加到park&#x3D;nearby和size&#x3D;50的联盟后的全部贡献</p>\n<p>将以下全部联盟的贡献都找完，计算带有和不带有cat&#x3D;banned特征值的预测公寓价格，并计算差值来获得边际贡献，将边际贡献求出（加权）平均值，从而得出Shapley值。</p>\n<img src=\"C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20240725183812909.png\" alt=\"image-20240725183812909\" style=\"zoom: 67%;\" /> \n\n\n\n","text":"Shapley值1953年，Shapley值首次提出。Lloyd Shapley在论文《A Value for n-Person Games》中首次提出Shap...","permalink":"/post/Shapley","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"机器学习","slug":"机器学习","count":3,"path":"api/categories/机器学习.json"}],"tags":[{"name":"SHAP","slug":"SHAP","count":1,"path":"api/tags/SHAP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Shapley%E5%80%BC\"><span class=\"toc-text\">Shapley值</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Shapley%E5%80%BC%E8%AE%A1%E7%AE%97\"><span class=\"toc-text\">Shapley值计算</span></a></li></ol>","author":{"name":"Sonderlin","slug":"blog-author","avatar":"https://raw.githubusercontent.com/sonder-lin/Mypic/img/img/%E5%A4%B4%E5%83%8F.jpg","link":"/","description":"一位正在重塑知识的小蒟蒻~ <br /> <b><i>过了河便是繁星。</i></b> <br /><br /> @ <b>qq：1425906813</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Hexo博客配置时遇到的问题","uid":"de3a9296d5a1bb4a6f357efb2f755731","slug":"Hexo博客配置时遇到的问题","date":"2024-08-28T12:14:59.000Z","updated":"2024-11-04T04:45:42.090Z","comments":true,"path":"api/articles/Hexo博客配置时遇到的问题.json","keywords":null,"cover":null,"text":"Hexo博客配置时遇到的问题hexo博客代码高亮失效吐血了。。。csdn真一坨XX。。。网上找了半天才发现是hexo的版本高于7.0.0时代码高亮就会失效。 b...","permalink":"/post/Hexo博客配置时遇到的问题","photos":[],"count_time":{"symbolsCount":349,"symbolsTime":"1 mins."},"categories":[{"name":"博客管理","slug":"博客管理","count":2,"path":"api/categories/博客管理.json"}],"tags":[{"name":"博客配置问题","slug":"博客配置问题","count":1,"path":"api/tags/博客配置问题.json"}],"author":{"name":"Sonderlin","slug":"blog-author","avatar":"https://raw.githubusercontent.com/sonder-lin/Mypic/img/img/%E5%A4%B4%E5%83%8F.jpg","link":"/","description":"一位正在重塑知识的小蒟蒻~ <br /> <b><i>过了河便是繁星。</i></b> <br /><br /> @ <b>qq：1425906813</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DOH隧道工具使用","uid":"977ed608adc923ebbb0d8daa2e5720c8","slug":"DOH隧道工具使用","date":"2024-07-07T06:05:49.000Z","updated":"2024-08-29T08:52:25.987Z","comments":true,"path":"api/articles/DOH隧道工具使用.json","keywords":null,"cover":null,"text":"dns2tcp使用教程https://www.jianshu.com/p/9e8367fee777 文件传输netcat工具安装https://blog.csd...","permalink":"/post/DOH隧道工具使用","photos":[],"count_time":{"symbolsCount":215,"symbolsTime":"1 mins."},"categories":[{"name":"DNS","slug":"DNS","count":1,"path":"api/categories/DNS.json"}],"tags":[{"name":"DoH隧道","slug":"DoH隧道","count":1,"path":"api/tags/DoH隧道.json"}],"author":{"name":"Sonderlin","slug":"blog-author","avatar":"https://raw.githubusercontent.com/sonder-lin/Mypic/img/img/%E5%A4%B4%E5%83%8F.jpg","link":"/","description":"一位正在重塑知识的小蒟蒻~ <br /> <b><i>过了河便是繁星。</i></b> <br /><br /> @ <b>qq：1425906813</b>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}